/* ========= Thème & base ========= */
:root{
  --bg:#0e1117; --panel:#141a24; --ink:#e8eef6; --muted:#9bb1c9; --border:#233149;
  --acc:#6ae3ff; --ok:#80f2a1; --warn:#ffd166; --bad:#ff7b7b;
}
*{box-sizing:border-box}
html,body{background:var(--bg);color:var(--ink);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;margin:0}
.wrap{max-width:1220px;margin:0 auto;padding:16px}

/* ========= Typo ========= */
h1{font-size:20px;margin:0}
h2{font-size:16px;margin:0;color:var(--acc)}
.h3tight{margin:0 0 6px;font-size:13px;color:#b9c9de}
.small{font-size:12px;color:#9fb2cb}
.op9{opacity:.9}

/* ========= Layout utilitaires ========= */
.grid{display:grid;gap:12px}
.cols{grid-template-columns:repeat(12,minmax(0,1fr))}
.two{grid-template-columns:1fr 1fr}
.col-4{grid-column:span 4}
.col-8{grid-column:span 8}
@media (max-width:1024px){
  .col-4,.col-8{grid-column:span 12}
  .two{grid-template-columns:1fr}
}
.mt4{margin-top:4px}.mt6{margin-top:6px}.mt8{margin-top:8px}.mt10{margin-top:10px}.mt12{margin-top:12px}
.mb8{margin-bottom:8px}
.m0{margin:0}
.pos-rel{position:relative}
.flex{display:flex;gap:8px;align-items:center}
.flex-end{display:flex;align-items:end}
.flex-wrap{display:flex;align-items:center;gap:12px;flex-wrap:wrap}
.btn-group{display:flex;gap:8px}

/* ========= Cartes / champs ========= */
.card{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:12px}
label{display:block;font-size:12px;color:#cfe1f7;margin:4px 0}
input,select,textarea{width:100%;background:#0b1018;color:var(--ink);border:1px solid var(--border);border-radius:9px;padding:9px 10px;font-size:14px}
input[type="checkbox"]{width:auto;transform:translateY(2px)}
textarea{min-height:88px}
.toolbar{display:flex;gap:8px;flex-wrap:wrap}
.btn{background:#182234;border:1px solid #27344b;border-radius:10px;color:#e7f1ff;font-weight:600;padding:8px 10px;cursor:pointer}
.btn.ghost{background:#0f1625}
.btn:active{transform:translateY(1px)}

/* ========= Header ========= */
.header{display:flex;align-items:center;justify-content:space-between;gap:8px;margin-bottom:6px}

/* ========= KPI ========= */
.kpis{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:12px}
.kpi{background:rgba(255,255,255,0.03);border:1px solid rgba(255,255,255,0.08);border-radius:12px;padding:12px;min-height:86px}
.kpi h3{margin:0 0 6px;font-size:13px;color:#b9c9de}
.kpi .v{font-variant-numeric:tabular-nums;font-size:18px}
.kpi.ok{border-color:#284c35;background:#0f2116}
.kpi.bad{border-color:#5a2323;background:#231014}

/* ========= Graph ========= */
canvas{width:100%!important;height:440px!important;background:#0b0f18;border:1px solid #1c273a;border-radius:12px}

/* ========= Bannières ========= */
.warnBanner{display:none;margin-top:8px;background:#2a1a1a;border:1px solid #5a2323;border-radius:8px;padding:8px 10px;color:#ffc1c1}
.warnBanner.show{display:block}

/* ========= Encart “règle appliquée” ========= */
.rule-box{
  margin-top:10px;padding:8px 12px;background:#101725;border:1px solid #2a3b58;border-radius:8px;
  font-size:.9rem;color:#cfe1f7
}

/* ========= Tooltip générique ========= */
.help{
  position:relative;display:inline-flex;align-items:center;justify-content:center;
  width:22px;height:22px;border-radius:999px;border:1px solid #2a3b58;background:#101725;color:#cfe1f7;
  font-weight:700;cursor:pointer;user-select:none
}
.help:hover{background:#0f1625}
.help:focus{outline:2px solid #385173;outline-offset:2px}

/* conteneur réutilisable (propre) */
.help-wrap{ position:relative; display:inline-flex; align-items:center; }
.help-bubble{
  position:absolute; top:30px; right:0; z-index:20; display:none;
  width:min(360px,72vw); background:#0f1625; color:#e8eef6;
  border:1px solid #2a3b58; border-radius:10px; paddi
